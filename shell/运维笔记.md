# shell命令合集
## 磁盘
* 磁盘空间不足需要快速定位日志目录
```shell
du -x --max-depth=1 / |sort -k1 -nr
```
* 系统产生很多碎片文件，导致inode资源不足
```
find -type f |awk -F / -v OFS=/ '{$NF="";dir[$0]++}END{for(i in dir)print dir[i]""i}' |sort -k1 -nr |head
```
## 文件操作
* 批量插在文件内容替换
```
find ./ -type name  a.txt -exec sed -i "s/aaaa/bbbb/g" {} \;
```
* 批量查找文件拷贝打包
```
(find . -name "*.log"|xargs tar -zcvf test.tar.gz) && cp -f test.tar.gz /home/.
```
## 主机状态
* 网络状态分析
```
netstat -n | awk '/^tcp/{++S[$NF]}END{for (a in S)print a,S[a]}'
```
* 提取主机上ip信息
```
ip a | grep global | awk '{print $2}' |awk -F / '{print $1}'
```


## nginx
* nginx优化
  * 基础优化
    * cpu新和性优化
    * nginx模型优化
    * nginx传输方式优化
    * nginx文件压缩优化
  * 缓存配置优化
